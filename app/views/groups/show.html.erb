<div>Billcrush: <%= @group.name %></div>


<h3>Members</h3>
<ul>
<% @members.each do |member| %>
  <li><%= member.name %> - <%= money(member.balance) %></li>
<% end %>
</ul>

<h3>Transactions</h3>
<table>
  <tr>
    <th>Payer</th>
    <th>Description</th>
  <% @group.members.each do |member|%>
    <th><%= member.name %></th>
  <% end %>
    <th>Total</th>
  </tr>
<% @transactions.each do |transaction| %>
  <tr>
    <%# cheating here by assuming only one payer %>
    <td><%= transaction.credits.first.member.name %></td>
    <td><%= transaction.description %></td>
    <% @group.members.each do |member| %>
      <td><%= money(member.debits_for_transaction(transaction)) %></td>
    <% end %>
    <td><strong><%= money(transaction.amount) %></strong></td>
  </tr>
<% end %>
</table>

<h3>Best Way to Settle</h3>
<ul>
<% @group.best_way_to_settle.each do |settlement| %>
  <li><%= settlement[:payer].name %> pays <%= settlement[:payee].name %> <%= money(settlement[:amount]) %></li>
<% end %>
</ul>



<%= form_for [@group, @new_member] do |f| %>
  <%= f.label(:name) %>
  <%= f.text_field(:name) %>
  <%= f.submit %>
<% end %>

<%= form_for [@group, @new_transaction] do |tf| %>
  <%= tf.label :payer, "Paid by" %>
  <%= collection_select(:transaction, :payer, @group.members, :id, :name) %>
  <%= tf.label :description %>
  <%= tf.text_field :description %>
  <%= tf.label :amount, "Total amount" %>
  <%= tf.text_field :amount %>
  <% @members.each do |member| %>
    <label for="transaction_<%= member.to_param %>_amount"><%= member.name %></label>
    <input type="hidden" name="transaction[members][][id]" value="<%= member.to_param %>" />
    <input id="transaction_<%= member.to_param %>_amount" name="transaction[members][][amount]" size="6" type="text" />
  <% end %>
  <%= tf.submit %>
<% end %>